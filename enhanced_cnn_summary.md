# 增强版CNN模型训练结果总结

## 1. 模型配置

### 增强版CNN模型
- **输入维度**: 52
- **序列长度**: 13
- **卷积层数**: 2
- **卷积核数量**: [16, 32]
- **卷积核大小**: [5, 3]
- **全连接层**: [128, 64, 32, 16, 1]
- **学习率**: 0.001
- **批次大小**: 256
- **训练轮数**: 10
- **总参数数量**: 28,449

### 原始CNN模型
- **输入维度**: 52
- **序列长度**: 13
- **卷积层数**: 2
- **卷积核数量**: [16, 32]
- **卷积核大小**: [5, 3]
- **全连接层**: [128, 64, 32, 1]
- **学习率**: 0.001
- **批次大小**: 512
- **训练轮数**: 5
- **总参数数量**: 27,937

## 2. 训练结果

### 增强版CNN模型
- **最终训练损失**: 33,767.39
- **最终验证损失**: 9,470.05
- **最佳验证损失**: 5,154.09
- **总训练轮数**: 10

### 原始CNN模型
- **最终训练损失**: 23,302.63
- **最终验证损失**: 5,125.98
- **最佳验证损失**: 5,125.98
- **总训练轮数**: 5

## 3. 评估结果

| 指标 | 原始CNN | 增强版CNN | 改进百分比 |
|------|---------|-----------|------------|
| MSE (均方误差) | 5,033.79 | 9,701.49 | -92.73% |
| RMSE (均方根误差) | 70.95 | 98.50 | -38.83% |
| MAE (平均绝对误差) | 50.06 | 74.97 | -49.77% |
| R² (决定系数) | 0.9696 | 0.9415 | -2.90% |

## 4. 预测示例

### 增强版CNN模型 (前5个样本)
1. 预测值=354.23, 实际值=401.92, 误差=47.69
2. 预测值=440.85, 实际值=539.34, 误差=98.49
3. 预测值=223.12, 实际值=273.43, 误差=50.31
4. 预测值=453.71, 实际值=476.43, 误差=22.72
5. 预测值=259.52, 实际值=316.04, 误差=56.52

## 5. 分析结论

1. **性能比较**:
   - 原始CNN模型在所有评估指标上都优于增强版CNN模型
   - 增强版CNN的MSE增加了92.73%，RMSE增加了38.83%，MAE增加了49.77%
   - 增强版CNN的R²降低了2.90%，表明对数据的解释能力减弱

2. **可能的原因**:
   - 增强版CNN增加了额外的全连接层(16个神经元)，可能导致模型过于复杂
   - 增加的参数可能导致过拟合，特别是在训练数据有限的情况下
   - 原始CNN模型的结构可能更适合当前的数据集
   - 增强版CNN可能需要更多的训练轮数或不同的学习率来达到最佳性能

3. **改进建议**:
   - 尝试减少增强版CNN的全连接层大小
   - 增加正则化技术，如dropout或L2正则化
   - 调整学习率和训练轮数
   - 尝试不同的优化器
   - 增加训练数据或使用数据增强技术

## 6. 总结

增强版CNN模型在医疗保险费用预测任务上的表现不如原始CNN模型。尽管增加了额外的全连接层，但模型性能反而下降，这表明在当前数据集上，更简单的模型结构可能更为适合。原始CNN模型的R²分数为0.9696，表明模型可以解释约96.96%的数据变异，而增强版CNN的R²分数为0.9415，只能解释约94.15%的数据变异。

## 7. 文件输出

本次训练生成了以下文件：
- `enhanced_cnn_evaluation.json`: 评估结果和模型配置
- `enhanced_cnn_model.pth`: 训练好的模型权重
- `enhanced_cnn_training_history.png`: 训练历史曲线图
- `enhanced_cnn_metrics.png`: 评估指标可视化
- `model_comparison.png`: 模型比较图表
- `test_enhanced_cnn_model.pth`: 测试模型权重